"use strict";(self.webpackChunksite_3=self.webpackChunksite_3||[]).push([[3989],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>f});var o=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=o.createContext({}),s=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),u=i,f=d["".concat(c,".").concat(u)]||d[u]||m[u]||r;return n?o.createElement(f,a(a({ref:t},p),{},{components:n})):o.createElement(f,a({ref:t},p))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,a=new Array(r);a[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:i,a[1]=l;for(var s=2;s<r;s++)a[s]=n[s];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},48016:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(58168),i=(n(96540),n(15680));const r={},a="BP-68: Delete cookie as part of bookkeeper decommission",l={type:"mdx",permalink:"/bps/BP-68-add-cookie-delete-in-decommission-API",source:"@site/src/pages/bps/BP-68-add-cookie-delete-in-decommission-API.md",title:"BP-68: Delete cookie as part of bookkeeper decommission",description:"Motivation",frontMatter:{}},c=[{value:"Motivation",id:"motivation",level:3},{value:"Public Interfaces",id:"public-interfaces",level:3},{value:"Proposed Changes",id:"proposed-changes",level:3},{value:"Compatibility, Deprecation, and Migration Plan",id:"compatibility-deprecation-and-migration-plan",level:3},{value:"Test Plan",id:"test-plan",level:3}],s={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,i.yg)(p,(0,o.A)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"bp-68-delete-cookie-as-part-of-bookkeeper-decommission"},"BP-68: Delete cookie as part of bookkeeper decommission"),(0,i.yg)("h3",{id:"motivation"},"Motivation"),(0,i.yg)("p",null,(0,i.yg)("em",{parentName:"p"},"The current decommission process in Apache BookKeeper has two main interfaces: the REST API and the command-line interface (CLI). However, there is a discrepancy between these two methods, specifically in the handling of cookie deletion. The CLI includes logic for deleting cookies associated with decommissioned Bookies, while the REST API lacks this functionality. This BP proposes enhancing the REST API to include cookie deletion logic, aligning it with the behavior of the CLI.")),(0,i.yg)("h3",{id:"public-interfaces"},"Public Interfaces"),(0,i.yg)("p",null,(0,i.yg)("em",{parentName:"p"},"api/v1/autorecovery/decommission"),"\nadd the following in payload:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"delete_cookie\n")),(0,i.yg)("p",null,"default value is false, which means do not delete the Cookie."),(0,i.yg)("h3",{id:"proposed-changes"},"Proposed Changes"),(0,i.yg)("p",null,(0,i.yg)("em",{parentName:"p"},"Implement the same cookie deletion logic present in the CLI within the REST API. This ensures that when a Bookie is decommissioned via the REST API, all associated cookies are removed, preventing any stale or conflicting state.")),(0,i.yg)("h3",{id:"compatibility-deprecation-and-migration-plan"},"Compatibility, Deprecation, and Migration Plan"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"The current behavior can be preserved as a default, with the cookie deletion being an optional feature that can be toggled via request parameters.")),(0,i.yg)("h3",{id:"test-plan"},"Test Plan"),(0,i.yg)("p",null,(0,i.yg)("em",{parentName:"p"},"Tests to make sure cookies are getting removed as part of the decommission")))}d.isMDXComponent=!0}}]);